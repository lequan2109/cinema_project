

{% extends 'cinema_app/base.html' %}
{% block title %}Trang chủ — Cinema{% endblock %}
{% block content %}

<ul class="nav nav-tabs mb-4" id="homeTab" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="now-showing-tab" data-bs-toggle="tab" data-bs-target="#now-showing-pane"
            type="button" role="tab">
            <i class="fas fa-play-circle me-1"></i> Phim Đang Chiếu
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="coming-soon-tab" data-bs-toggle="tab" data-bs-target="#coming-soon-pane"
            type="button" role="tab">
            <i class="fas fa-calendar-alt me-1"></i> Phim Sắp Chiếu
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="schedule-tab" data-bs-toggle="tab" data-bs-target="#schedule-pane" type="button"
            role="tab">
            <i class="fas fa-clock me-1"></i> Suất Chiếu Sắp Tới
        </button>
    </li>
</ul>

<div class="tab-content" id="homeTabContent">
    
    <div class="tab-pane fade show active" id="now-showing-pane" role="tabpanel">
        <div class="row row-cols-1 row-cols-md-4 row-cols-lg-5 g-4">
            {% for m in now_showing_movies %}
            <div class="col">
                <div class="card h-100 shadow-sm movie-card">
                    {% if m.poster %}
                    <img src="{{ m.poster.url }}" class="card-img-top" alt="{{ m.title }}" />
                    {% endif %}
                    <div class="card-body d-flex flex-column">
                        <h6 class="card-title text-truncate" title="{{ m.title }}">{{ m.title }}</h6>
                        <p class="card-text small text-muted flex-grow-1">
                           {{ m.genre }} • {{ m.duration }} phút
                        </p>
                        <a href="{% url 'movie_detail' m.id %}" class="btn btn-primary w-100 stretched-link">Xem chi tiết</a>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12">
                <p class="text-muted">Chưa có phim đang chiếu.</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="tab-pane fade" id="coming-soon-pane" role="tabpanel">
        <div class="row row-cols-1 row-cols-md-4 row-cols-lg-5 g-4">
            {% for m in coming_soon_movies %}
            <div class="col">
                <div class="card h-100 shadow-sm movie-card">
                    {% if m.poster %}
                    <img src="{{ m.poster.url }}" class="card-img-top" alt="{{ m.title }}" />
                    {% endif %}
                    <div class="card-body d-flex flex-column">
                        <h6 class="card-title text-truncate" title="{{ m.title }}">{{ m.title }}</h6>
                        <p class="card-text small text-muted flex-grow-1">
                           {{ m.genre }} • {{ m.duration }} phút
                        </p>
                         <p class="card-text small">
                           Khởi chiếu: <strong>{{ m.release_date|date:'d/m/Y' }}</strong>
                        </p>
                        <a href="{% url 'movie_detail' m.id %}" class="btn btn-outline-secondary w-100 stretched-link">Xem chi tiết</a>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12">
                <p class="text-muted">Chưa có phim sắp chiếu.</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="tab-pane fade" id="schedule-pane" role="tabpanel">
         <div class="list-group">
            {% for st in upcoming_showtimes %}
                <a href="{% url 'booking' st.id %}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                    <div>
                        <h5 class="mb-1">{{ st.movie.title }}</h5>
                        <p class="mb-1 text-muted">
                            <i class="fas fa-clock me-1"></i> {{ st.start_time|date:'H:i' }} - {{ st.start_time|date:'d/m/Y' }}
                            <i class="fas fa-door-open ms-3 me-1"></i> {{ st.room.name }}
                        </p>
                    </div>
                    <span class="btn btn-primary btn-sm">
                       <i class="fas fa-ticket-alt me-1"></i> Đặt vé
                    </span>
                </a>
            {% empty %}
                <p class="text-muted">Chưa có suất chiếu nào sắp tới.</p>
            {% endfor %}
         </div>
    </div>
</div>

<style>
.movie-card img {
    height: 300px;
    object-fit: cover;
}
.movie-card {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.movie-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.1) !important;
}
.card-title {
    font-size: 1rem;
    font-weight: 600;
}
.nav-link {
    font-weight: 500;
}
.list-group-item-action:hover h5 {
    color: var(--bs-primary);
}
</style>

{% endblock %}